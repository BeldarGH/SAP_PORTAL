function notifyFinishLoading(){if(typeof(AFPLayoutAPI)!=="undefined"){AFPLayoutAPI.notifyOnFinishLoading("AFPMasthead")}}var callAddWidgets=function(a){if(LSAPI.AFPPlugin.configuration==null){waitForObject("LSAPI.AFPPlugin.configuration",addWidgets,a)}else{addWidgets(a)}};function openNewWindow(){LSAPI.AFPPlugin.service.openNewPortalWindow()}function openSAPStoreWindow(){window.open(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue("AFPMasthead","SAPStoreURL"))}var closePortalPlace=function(){var a=LSAPI.AFPPlugin.configuration.getAttributeValue("portalPlaceBackUrl");portalUrl=document.location.protocol+"//"+document.location.host+a;EPCM.getSAPTop().document.location.href=portalUrl;return};var updateWidgetsMenus=function(b){var a=AFPMasthead.getMenusConfiguration();if(!JSUtils.isEmpty(b)){a.menuItems=b}drawMenus(a)};var AFPMasthead=function(){var S="";var y="";var A="";var ae=null;var af="";var R="";var N="providersButton";var g="searchButton";var F="searchButtonImageSpan";var z="";var ag=null;var v=null;var b=null;var W="AFPMasthead";var f="AFPMasthead.AFPMastheadStrings";var d="AFPWidgets";var I={};var a=false;var c=true;var p=null;var l=false;var Z=function(aj,ak,ai,am,al,ah){S=aj;R=ak;y=ai;A=am;if(al){K(al)}if(AccessibilityManager.isAccessibilityModeOn()){window.setTimeout("JSUtils.$('mastheadEntry').focus();",1500)}af=ah;if(!l){x()}if(typeof(AFPLayoutAPI)!=="undefined"){AFPLayoutAPI.notifyOnFinishLoading("AFPMasthead")}};function B(){var ah=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"collaborateLinkTitle");collaborateHyperLink=JSUtils.$("collaborate_container");if(collaborateHyperLink==null){return}collaborateHyperLink.title=ah;collaborateHyperLink.onkeydown=function(aj){var ai=aj||window.event;if(ai.keyCode==AccessibilityManager.KEY_ENTER||ai.keyCode==AccessibilityManager.KEY_SPACE){i()}};JSUtils.$("collaborate").style.marginRight="10px"}var V=function(){I=LSAPI.AFPPlugin.configuration.getClientSideAttributes(f);l=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"isPreview"));var az=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"customLogoURL");var aH=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"showLogo"));var ay=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"showNewWindowValue"));var al=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"showSAPStoreLink"));var aQ=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"SAPStoreURL");var at=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"SAPStoreURLTitle");var ai=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"showCollaborateValue"));var aP=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"showHelpLink"));var ao=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(d,"com.sap.portal.navigation.afp.showHelpCenter"));var aA=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"showLogInLogOffValue"));var au=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"anonymous"));var aL=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"isShowLoggedAsMessage"));var aj=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"isShowMenuBarContainer"));var aG=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"isPortalPlaceMode"));if(!l){a=true;c=true;p=null;EPCM.getSAPTop().LSAPI.AFPPlugin.controller.registerOnNavigate(AFPMasthead.callInit)}if(aH){T(az)}if(ai){B()}if(aG&&!l){var aw=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"backToMainPortalLink");var aD=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"PORTAL_PLACE_BACK_ACC_TOOLTIP");var aI=NovaHyperlink.createNovaHyperlink("back_to_main",aw);if(aI!=null){aI.title=aw;AccessibilityManager.setElementTabIndex(aI);AccessibilityManager.setElementAccessibilityTooltip(aI,aD);aI.onkeydown=function(aS){var aR=aS||window.event;if(aR.keyCode==AccessibilityManager.KEY_ENTER||aR.keyCode==AccessibilityManager.KEY_SPACE){closePortalPlace()}};aI.onmouseup=closePortalPlace}}if(ay){var ap=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"newWindowHyperlink");var am=NovaHyperlink.createNovaHyperlink("new_window",ap);am.title=ap;am.onkeydown=function(aS){var aR=aS||window.event;if(aR.keyCode==AccessibilityManager.KEY_ENTER||aR.keyCode==AccessibilityManager.KEY_SPACE){openNewWindow()}};am.onmouseup=function(aR){openNewWindow()}}if(al){var aE=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"SAPStoreURLTitle");var aC=NovaHyperlink.createNovaHyperlink("SAPStoreLink",aE);aC.title=at;aC.onkeydown=function(aS){var aR=aS||window.event;if(aR.keyCode==AccessibilityManager.KEY_ENTER||aR.keyCode==AccessibilityManager.KEY_SPACE){openSAPStoreWindow()}};aC.onmouseup=function(aR){openSAPStoreWindow()}}if(aP&&ao&&!l){var aN=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"helpLinkHyperLink");helpLinkElement=NovaHyperlink.createNovaHyperlink("helpLink",aN);helpLinkElement.title=aN;var aK=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"ACC_HELP");AccessibilityManager.setElementAccessibilityTooltip(helpLinkElement,aK)}if(aA&&!l){if(au){var aB=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"logOnTextStr");logonLinkElement=NovaHyperlink.createNovaHyperlink("logon",aB);logonLinkElement.title=aB;var aM=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"LOG_ON_TOOLTIP");AccessibilityManager.setElementAccessibilityTooltip(logonLinkElement,aM);logonLinkElement.onmouseup=function(aR){var aS=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"LOGIN_URL");location.replace(aS)};logonLinkElement.onkeydown=function(aR){this.onmouseup()}}else{var ah=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"logoffHyperlink");logoffLinkElement=NovaHyperlink.createNovaHyperlink("logoff",ah);logoffLinkElement.title=ah;var aJ=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"logoffTitle");var ax=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"logoffMessage");var an=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"ACC_BUTTON_YES");var aF=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"ACC_BUTTON_NO");var aO=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"logoffYesButton");var av=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"logoffNoButton");logoffLinkElement.onkeydown=function(aV){var aS;var aR=aV||window.event;if(aR.keyCode==AccessibilityManager.KEY_ENTER||aR.keyCode==AccessibilityManager.KEY_SPACE){aS=NovaDialogBox.createLogoffDialogBox(aJ,ax,aO,av,"260","126");AccessibilityManager.setItemOpenerElement(logoffLinkElement);var aU=aS[0];AccessibilityManager.setElementAccessibilityTooltip(aU,ax+" "+an);var aT=aS[1];AccessibilityManager.setElementAccessibilityTooltip(aT,aF)}};logoffLinkElement.onmouseup=function(aS){var aR=aS||window.event;NovaDialogBox.createLogoffDialogBox(aJ,ax,aO,av,"260","126")}}}if(aj&&!l){AFPMenubar.drawMenubar("menubar");var ar=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"welcomeMessageMarkUp");var ak=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"welcomeMessageTitle");if(aL){var aq=JSUtils.$("welcome_message_container");aq.innerHTML=ar;aq.title=ak;AccessibilityManager.setElementTabIndex(aq);AccessibilityManager.setActualSkipableElement(aq,"menubarPanelElement")}}};var e=function(){return I};var k=function(){this.initMastheadAccessibility=true;this.firstTimeFlag=true;p=null;EPCM.getSAPTop().LSAPI.AFPPlugin.controller.registerOnNavigate(aa)};var aa=function(){if(c){c=false;var ai=null;var am=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"enableQuickLaunch"));if(am){ai="quickLaunchText"}var aj=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"menusConfig");var al=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"MI_HELP");var ah=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"HELP_URL");var an=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"filterAppliedTitle");var ak=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"filterAppliedTooltip");AFPMasthead.init(al,ah,an,ak,ai,aj);this.showView=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"showView"));if(showView){LSAPI.getVisualPlugin().registerScreenModeChangeNotification(AFPMenubar.handleFullScreen)}top.LSAPI.getTabsetPlugin().registerOnTabsetSwitch(AFPMasthead.applyTabsetFilter);AFPMasthead.applyTabsetFilter()}};var H=function(ah){p=ah;if(!c){updateWidgetsMenus(p)}};var i=function(){var ai=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"collaborateComponent");var al=JSUtils.getBooleanValue(LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"isByD"));var am=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"collaborateLinkTitle");if(ai!=null){if(al){var ah=ai;var ak="toolbar=no,resizable=yes";LSAPI.AFPPlugin.service.navigate(ah,"6",null,null,ak)}else{var aj=LSAPI.AFPPlugin.configuration.getClientSideAttributeValue(W,"clpComponentURI");clpParameter="height=510,width=322,location=No,menubar=No,resizable=Yes,scrollbars=Yes,status=No,titlebar=No,toolbar=No,left="+(screen.width/3)+",top=180";clp_wnd=window.open(aj,"STATIC_CLP_WINDOW_TITLE",clpParameter);clp_wnd.focus()}}};function T(ai){if(JSUtils.isEmpty(ai)){return}var ah=JSUtils.$("logo");if(ah==null){return}if(JSUtils.BrowserDetection.is_ie){ah.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ai+"',sizingMethod='crop')"}else{ah.style.backgroundImage="url("+ai+")"}}var Q=function(ah){JSUtils.$(ah).className="collaboration_link cl_inactive cl_hover"};var D=function(ah){JSUtils.$(ah).className="collaboration_link cl_active"};var x=function(){var ak=AccessibilityManager.getElementById("mastheadEntry");AccessibilityManager.setElementTabIndex(ak);AccessibilityManager.setElementAccessibilityTooltip(ak,I.mastheadToolTip);AccessibilityManager.setSkipableElement(AccessibilityManager.MASTHEAD_ENTRY,ak);AccessibilityManager.setEntryId(AccessibilityManager.MASTHEAD_ENTRY,ak.id);AccessibilityManager.setElementAccessKey(ak,"M");var aj=JSUtils.$("buttonlogoff");if(aj){AccessibilityManager.setElementAccessibilityTooltip(JSUtils.$("buttonlogoff"),I.accLogOffLinkString)}var ah=JSUtils.$("collaborate");if(ah){AccessibilityManager.setElementAccessibilityTooltip(JSUtils.$("collaborate"),I.accCollaborateLinkString)}var ai=JSUtils.$("buttonnew_window");if(ai){AccessibilityManager.setElementAccessibilityTooltip(JSUtils.$("buttonnew_window"),I.accNewWindowLinkString)}};var ab=function(){var ai=LSAPI.AFPPlugin.model.getCurrentSelectedPath();var ah=ai[0];return ah.getName()};var L=function(){if(typeof(parent.EPCM)!="undefined"){var ai="OBN://BOTechnicalName=LearningCenter/Operation=DisplayLearningCenter";var ah="toolbar=no";if(LSAPI.AFPPlugin.configuration!=null){var aj=LSAPI.AFPPlugin.configuration.getAttributeValue("learningCenterNavTarget");if(aj!=null){ai=aj}aj=LSAPI.AFPPlugin.configuration.getAttributeValue("learningCenterWinFeatures");if(aj!=null){ah=aj}aj=LSAPI.AFPPlugin.configuration.getAttributeValue("learningCenterAdditionalParam");if(aj!=null&&aj!=""){ai=ai+"?"+aj}}parent.EPCM.doNavigate(ai,3,ah,null,null,null,null,null)}};var C=function(){if(LSAPI!=null){var ah=false;var ai=LSAPI.getScreenCapturingPlugin();if(ai!=null){ai.captureScreen(ah)}else{window.alert("No Screen Capture plugin defined!")}}else{window.alert("No Screen Capture mode defined!")}};var w=function(){return af};var u=function(){var ah=LSAPI.getTabsetPlugin().isEnabled();var ai=LSAPI.getTabsetPlugin().getCurrentTabset();if(ah&&(ai!="ALL")){return true}return false};var G=function(){var ah=JSUtils.$("filter_applied");var ai=JSUtils.$("filter_applied_divider");if(ah&&ai){if(u()){ah.innerHTML=y;ah.title=A;ai.style.display="block"}else{ah.innerHTML="";ah.title="";ai.style.display="none"}}};var K=function K(ah){z=ah;var ai=JSUtils.$(z);AccessibilityManager.setElementAccessibilityTooltip(ai,I.qlInputBoxToolTip);EPCM.getSAPTop().LSAPI.getSearchProviderPlugin().getProviders(s);AFPMasthead.quickLaunchCombo=new QuickLaunchCombo(z,"quickLaunchContainer");ai.onkeyup=AFPMasthead.quickLaunchCombo.quickLaunchOnKeyUp;ai.onkeydown=AFPMasthead.quickLaunchCombo.quickLaunchOnKeyDown};var o=function o(aj){var ah=aj||window.event;var ai=(b&&b.isOpen());switch(ah.keyCode){case AccessibilityManager.KEY_ENTER:case AccessibilityManager.KEY_SPACE:if(ai){b.navigationKeyPressed(ah.keyCode)}else{q();X();M()}break}};var t=function t(ai){var ah=ai||window.event;if(ah.keyCode==AccessibilityManager.KEY_ENTER||ah.keyCode==AccessibilityManager.KEY_SPACE){Y();X();ad()}};var ad=function ad(){if(AFPMasthead.quickLaunchCombo&&AFPMasthead.quickLaunchCombo.startSearch&&AFPMasthead.quickLaunchCombo.startSearch()){var ah=JSUtils.$(z);if(ah){ah.value=""}AFPMasthead.quickLaunchCombo.newOnBlur()}};var M=function M(){if(!ag&&!v){EPCM.getSAPTop().LSAPI.getSearchProviderPlugin().getProviders(AFPMasthead.updateProvidersList)}else{ac()}};var j=function j(ah){if(ah){ah=n(ah);ag=ah;v=U(ag);ac()}};var s=function s(ah){if(ah){ah=n(ah);ag=ah;v=U(ag);if(!JSUtils.isEmpty(ag)){r()}else{P()}}else{P()}};var n=function n(aj){for(var ai=0;aj&&ai<aj.length;ai++){var am=aj[ai];am.UnDisplayedUrl=[];for(var al=0;am.getSearchTypes()&&al<am.getSearchTypes().length;al++){var ak=am.getSearchTypes();var ah=ak[al];if(ah.rel=="suggestions"){am.Url.splice(al,1);am.UnDisplayedUrl.push(ah);al--}}}return aj};var r=function r(){AFPMasthead.quickLaunchCombo.init();var ai=JSUtils.$(N);if(ai){h("providersDownArrow","providersDownArrow_std");ai.onclick=M;ai.onmouseover=X;ai.onmouseup=X;ai.onmouseout=E;ai.onmousedown=q;ai.onkeyup=o;ai.onfocus=X;ai.onblur=E;if(LSAPI.AFPPlugin.configuration.isRTL()){ai.style.borderRight="none"}AccessibilityManager.setElementAccessibilityTooltip(ai,I.qlOptionsButtonToolTip)}var ah=JSUtils.$(g);if(ah){h("searchButtonImageSpan","shellSearchImage");ah.onclick=ad;ah.onmouseover=X;ah.onmouseup=X;ah.onmouseout=E;ah.onmousedown=Y;ah.onkeyup=t;ah.onfocus=X;ah.onblur=E;if(!LSAPI.AFPPlugin.configuration.isRTL()){ah.style.borderRight="none"}AccessibilityManager.setElementAccessibilityTooltip(ah,I.qlSearchButtonToolTip)}var aj=JSUtils.$(F);if(aj&&JSUtils.BrowserDetection.is_ie){aj.style.marginTop="1px"}};var P=function P(){AFPMasthead.quickLaunchCombo.init();var ai=JSUtils.$(N);if(ai){JSUtils.clearAllEventsFromElement(ai);h("providersDownArrow","providersDownArrow_stdDisabled");AccessibilityManager.setElementAccessibilityTooltip(ai,I.qlOptionsButtonDisableToolTip)}var ah=JSUtils.$(g);if(ah){JSUtils.clearAllEventsFromElement(ah);h("searchButtonImageSpan","shellSearchImageDisabled");AccessibilityManager.setElementAccessibilityTooltip(ah,I.qlSearchButtonDisableToolTip)}};var U=function U(al){var ak=new LSAPI.Collections.Item("searchProvidersList",null,null,null,null);var am=EPCM.getSAPTop().LSAPI.getSearchProviderPlugin().getDefaultProvider();for(var ai=0;ai<al.length;ai++){var ah=al[ai];var aj=new LSAPI.Collections.Item(ah.getKey(),ah.getName(),null,ah.getDescription(),AFPMasthead.switchSearchProvider);if(am.getProviderType()==ah.getProviderType()){aj.selected=true}ak.addItem(aj)}return ak};var m=function m(ah){O(ah,true,true);EPCM.getSAPTop().LSAPI.getSearchProviderPlugin().setDefaultProvider(ah)};var O=function O(ak,ah,aj){var al=v.getChildItems();for(var ai=0;ai<al.length;ai++){if(al[ai].ID==ak){al[ai].selected=ah}else{if(aj){al[ai].selected=!ah}}}};var ac=function ac(){if(!v){return}b=new HierarchicalMenu(v,N,null,display_sub_menu_location.Below);b.selectFirstRow()};var X=function X(){J("quickLaunchButtonHover")};var E=function E(){h(g,"quickLaunchSearchButtonNormal");h(N,"quickLaunchProvidersButtonNormal")};var Y=function Y(){h(g,"quickLaunchButtonDown")};var q=function q(){h(N,"quickLaunchButtonDown")};var J=function J(ah){h(N,ah);h(g,ah)};var h=function h(ah,aj){var ai=JSUtils.$(ah);if(ai){ai.className=aj}};return{onLoad:V,callInit:aa,init:Z,getMastheadStrings:e,changeLinkToOverState:Q,changeLinkToRegularState:D,launchCollaboration:i,isTabSetsFilterApplied:u,applyTabsetFilter:G,onOpenLearningCenter:L,onOpenScreenCapture:C,quickLaunchCombo:ae,getMenusConfiguration:w,updateProvidersList:j,switchSearchProvider:m}}();EPCM.subscribeEventReliable("urn:com.sapportals.portal:browser","load",AFPMasthead.onLoad);